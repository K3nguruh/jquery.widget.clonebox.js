/**
 * Widget:  jquery.widget.clonebox.min.js
 *
 * Autor:   K3nguruh <https://github.com/K3nguruh>
 * Version: 1.0.0
 * Datum:   2024-04-02 17:04
 * Lizenz:  MIT-Lizenz
 */
!function(t){t.widget("custom.clonebox",{options:{limit:Number.MAX_SAFE_INTEGER,row:'[data-clone="row"]',add:'[data-clone-btn="add"]',del:'[data-clone-btn="del"]',invalid:"is-invalid",valid:"is-valid",disabled:"disabled"},_create:function(){this.options=t.extend(!0,{},this.options,this.element.data()),this._initWidget(),this._initEvents()},_initWidget:function(){const t=this.element.find(this.options.row),i=t.length>=this.options.limit;t.find(this.options.add).toggleClass(this.options.disabled,i).prop("disabled",i),t.find(this.options.add).not(":last").addClass(this.options.disabled).prop("disabled",!0),this._setAttributes()},_initEvents:function(){this._on(this.element,{["click "+this.options.add]:this._onClickAdd}),this._on(this.element,{["click "+this.options.del]:this._onClickDel})},_onClickAdd:function(t){t.preventDefault();const i=this.element.find(this.options.row),n=i.last();if(i.length>=this.options.limit)return;const o=n.clone(!0);n.after(o),this._resetInputs(o),this._initWidget()},_onClickDel:function(i){i.preventDefault();const n=this.element.find(this.options.row),o=t(i.currentTarget).closest(this.options.row);n.length>1&&o.remove(),this._resetInputs(o),this._initWidget()},_resetInputs:function(i){const n=t(i).find(":input");n.filter(":radio, :checkbox").prop("checked",!1),n.filter(":not(:button, :radio, :checkbox)").val(""),n.removeClass([this.options.invalid,this.options.valid])},_setAttributes:function(){this.element.find(this.options.row).each((function(i){t(this).find(":input[name], label[for]").each((function(n,o){const s=t(o).attr("for"),e=t(o).attr("name");if(s){const n=s.match(/^([-_a-zA-Z]+)(?:-\d*)?$/);if(n){const s=n[1];t(o).attr("for",`${s}-${i}`)}}if(e){const n=e.match(/^([-_a-zA-Z]+)(?:\[\d*\])?$/);if(n){const s=n[1];t(o).attr({id:`${s}-${i}`,name:`${s}[${i}]`})}}}))}))}}),t((function(){t('[data-plugin="clonebox"]').clonebox()}))}(jQuery);